Plop
======

å¾®å‹ç”Ÿæˆå™¨æ¡†æ¶ï¼Œä½¿æ•´ä¸ªå›¢é˜Ÿèƒ½å¤Ÿè½»æ¾åœ°åˆ›å»ºå…·æœ‰ä¸€è‡´æ€§çš„æ–‡ä»¶ã€‚
![plop demo](https://i.imgur.com/penUFkr.gif)

> [æ–‡æ¡£ä¹Ÿå¯ä»¥åœ¨ plopjs.com ä¸Šæ‰¾åˆ°](https://plopjs.com/documentation/)

# å…¥é—¨æŒ‡å—
[![npm](https://img.shields.io/npm/dm/plop.svg)](https://www.npmjs.com/package/plop)
&nbsp;
[![npm](https://img.shields.io/npm/v/plop.svg)](https://www.npmjs.com/package/plop)
&nbsp;
[![plop on slack](https://img.shields.io/badge/slack-join%20workspace-green)](https://join.slack.com/t/plopjs/shared_invite/zt-ehh69el1-2_DjgZRuMbpC9RnEa4M8cA)

## Plopæ˜¯ä»€ä¹ˆï¼Ÿ

æˆ‘å–œæ¬¢æŠŠ Plop ç§°ä¸ºâ€œå¾®å‹ç”Ÿæˆå™¨æ¡†æ¶â€ã€‚
ç°åœ¨ï¼Œæˆ‘ç§°å…¶ä¸ºâ€œå°å·¥å…·â€ï¼Œå› ä¸ºå®ƒä¸ºæ‚¨æä¾›äº†ä¸€ç§ä»¥ä¸€è‡´çš„æ–¹å¼ç”Ÿæˆä»£ç æˆ–ä»»ä½•å…¶ä»–ç±»å‹çš„çº¯æ–‡æœ¬æ–‡ä»¶çš„ç®€å•æ–¹æ³•ã€‚
æ‚¨ä¼šçœ‹åˆ°ï¼Œæˆ‘ä»¬éƒ½åœ¨ä»£ç ä¸­åˆ›å»ºäº†ç»“æ„å’Œæ¨¡å¼ï¼ˆè·¯ç”±ï¼Œæ§åˆ¶å™¨ï¼Œç»„ä»¶ï¼Œå¸®åŠ©ç¨‹åºç­‰ï¼‰ã€‚
è¿™äº›æ¨¡å¼ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œå˜åŒ–å’Œæ”¹è¿›ï¼Œå› æ­¤å½“æ‚¨éœ€è¦åœ¨æ­¤å¤„åˆ›å»ºæ–°çš„â€œåœ¨æ¨¡å¼ä¸­æ’å…¥åç§°â€æ—¶ï¼Œåœ¨ä»£ç åº“ä¸­æŸ¥æ‰¾ä»£è¡¨å½“å‰â€œæœ€ä½³å®è·µâ€çš„æ–‡ä»¶å¹¶ä¸æ€»æ˜¯é‚£ä¹ˆå®¹æ˜“ã€‚ é‚£å°±æ˜¯æŒ½æ•‘æ‚¨çš„åœ°æ–¹ã€‚ 
ä½¿ç”¨ plopï¼Œæ‚¨å°†æ‹¥æœ‰åœ¨ä»£ç ä¸­åˆ›å»ºä»»ä½•ç»™å®šæ¨¡å¼çš„â€œæœ€ä½³å®è·µâ€æ–¹æ³•ã€‚ å¯ä»¥é€šè¿‡é”®å…¥`plop`ä»ç»ˆç«¯è½»æ¾è¿è¡Œä»£ç ã€‚
è¿™ä¸ä»…ä½¿æ‚¨å…äºåœ¨ä»£ç åº“ä¸­å››å¤„å¯»æ‰¾è¦å¤åˆ¶çš„æ­£ç¡®æ–‡ä»¶ï¼Œè€Œä¸”è¿˜ä½¿â€œæ­£ç¡®çš„æ–¹å¼â€å˜æˆäº†â€œåˆ›å»ºæ–°æ–‡ä»¶çš„æœ€ç®€å•çš„æ–¹å¼â€ã€‚

å¦‚æœå°† plop å½’ç»“ä¸ºå®ƒçš„æ ¸å¿ƒï¼Œå®ƒåŸºæœ¬ä¸Šæ˜¯ [inquirer](https://github.com/SBoudrias/Inquirer.js/) ç¨‹åºæç¤ºç¬¦å’Œ
[handlebar](https://github.com/wycats/handlebars.js/) æ¨¡æ¿ä¹‹é—´çš„ç²˜åˆä»£ç ã€‚

> è¿™ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„å·¥ä½œã€‚å¦‚æœä½ æœ‰å¥½ä¸»æ„ï¼Œæˆ‘å¾ˆä¹æ„å¬å¬ã€‚

## å®‰è£…
### 1. å°†plopæ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®ä¸­
```
$ npm install --save-dev plop
```
### 2. å…¨å±€å®‰è£…plop(å¯é€‰ï¼Œä½†å»ºè®®, ä»¥ä¾¿äºè®¿é—®)
```
$ npm install -g plop
```
### 3. åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `plopfile.js`
``` javascript
module.exports = function (plop) {
	// è¿™é‡Œåˆ›å»ºè‡ªå·±çš„ç”Ÿæˆå™¨
	plop.setGenerator('basics', {
		description: 'è¿™æ˜¯ä¸€ä¸ªéª¨æ¶ plopfile',
		prompts: [], // inquirer ç¨‹åºæç¤ºç¬¦æ•°ç»„
		actions: []  // æ“ä½œæ•°æ®
	});
};
```

## ä½ çš„ç¬¬ä¸€ä¸ªPlopfile
plopfileä½œä¸ºä¸€ä¸ªä½çº§çš„èŠ‚ç‚¹æ¨¡å—å¼€å§‹å®ƒçš„ç”Ÿå‘½ï¼Œå®ƒå¯¼å‡ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å— `plop` å¯¹è±¡ä½œä¸ºå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚

``` javascript
module.exports = function (plop) {};
```

`plop` å¯¹è±¡æš´éœ²äº†åŒ…å« `setGenerator(name, config)` å‡½æ•°çš„ plop api å¯¹è±¡ã€‚
è¿™æ˜¯ç”¨äº(ç­‰å¾…)ä¸ºè¿™ä¸ª plopfile åˆ›å»ºç”Ÿæˆå™¨çš„å‡½æ•°ã€‚
å½“åœ¨è¿™ä¸ªç›®å½•(æˆ–ä»»ä½•å­ç›®å½•)çš„ç»ˆç«¯ä¸­è¿è¡Œ `plop` æ—¶ï¼Œå°†æ˜¾ç¤ºè¿™äº›ç”Ÿæˆå™¨çš„åˆ—è¡¨ã€‚

è®©æˆ‘ä»¬å°è¯•è®¾ç½®ä¸€ä¸ªåŸºæœ¬çš„ç”Ÿæˆå™¨ï¼Œçœ‹çœ‹æ•ˆæœå¦‚ä½•ã€‚

``` javascript
module.exports = function (plop) {
	// ç”Ÿæˆå™¨çš„æ§åˆ¶å™¨
	plop.setGenerator('controller', {
		description: 'åº”ç”¨ç¨‹åºæ§åˆ¶å™¨é€»è¾‘',
		prompts: [{
			type: 'input',
			name: 'name',
			message: 'è¯·è¾“å…¥æ§åˆ¶å™¨åç§°'
		}],
		actions: [{
			type: 'add',
			path: 'src/{{name}}.js',
			templateFile: 'plop-templates/controller.hbs'
		}]
	});
};
```

æˆ‘ä»¬ä¸Šé¢åˆ›å»ºçš„*æ§åˆ¶å™¨*ç”Ÿæˆå™¨å°†é—®æˆ‘ä»¬ä¸€ä¸ªé—®é¢˜ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ã€‚
è¿™å¯ä»¥æ‰©å±•ä¸ºæ ¹æ®éœ€è¦æå‡ºå°½å¯èƒ½å¤šçš„é—®é¢˜ï¼Œå¹¶åˆ›å»ºå°½å¯èƒ½å¤šçš„æ–‡ä»¶ã€‚
è¿˜æœ‰ä¸€äº›é¢å¤–çš„æ“ä½œå¯ä»¥ç”¨æ¥ä»¥ä¸åŒçš„æ–¹å¼æ”¹å˜æˆ‘ä»¬çš„ä»£ç åº“ã€‚

## ä½¿ç”¨æç¤º

Plopä½¿ç”¨[inquirer.js](https://github.com/SBoudrias/Inquirer.js)åº“æ¥æ”¶é›†ç”¨æˆ·æ•°æ®ã€‚
åœ¨ inquirer.js å®˜ç½‘å¯ä»¥æ‰¾åˆ°[prompt types](https://github.com/SBoudrias/Inquirer.js/#prompt-types)åˆ—è¡¨ã€‚

## CLI ä½¿ç”¨

å®‰è£…äº† plop å¹¶åˆ›å»ºäº†ä¸€ä¸ªç”Ÿæˆå™¨ä¹‹åï¼Œå°±å¯ä»¥ä»ç»ˆç«¯è¿è¡Œplopäº†ã€‚
è¿è¡Œä¸å¸¦å‚æ•°çš„ plop å°†æä¾›ä¸€ä¸ªç”Ÿæˆå™¨åˆ—è¡¨ä¾›æ‚¨é€‰æ‹©ã€‚
ä½ ä¹Ÿå¯ä»¥è¿è¡Œ `plop [generatorName]` æ¥ç›´æ¥è§¦å‘ä¸€ä¸ªç”Ÿæˆå™¨ã€‚
å¦‚æœä½ æ²¡æœ‰å…¨å±€å®‰è£… plopï¼Œä½ éœ€è¦è®¾ç½®ä¸€ä¸ª npm è„šæœ¬æ¥è¿è¡Œ plopã€‚

```javascript
// package.json
{
    ...,
    "scripts": {
        "plop": "plop"
    },
    ...
}
```

### ç»•è¿‡æç¤º

ä¸€æ—¦æ‚¨å¾ˆå¥½åœ°äº†è§£äº†ä¸€ä¸ªé¡¹ç›®(åŠå…¶ç”Ÿæˆå™¨)ï¼Œæ‚¨å¯èƒ½å¸Œæœ›åœ¨è¿è¡Œç”Ÿæˆå™¨æ—¶ä¸ºæç¤ºæä¾›ç­”æ¡ˆã€‚
ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘æœ‰ä¸€ä¸ªæœ‰ä¸€ä¸ªæç¤ºç¬¦(åç§°)çš„ `component` ç”Ÿæˆå™¨ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨ `plop component "some component name"` è¿è¡Œè¯¥ç”Ÿæˆå™¨ï¼Œ
å®ƒä¼šç«‹å³æ‰§è¡Œï¼Œå°±åƒæˆ‘åœ¨æç¤ºç¬¦ä¸­è¾“å…¥äº†"some component name"ä¸€æ ·ã€‚
å¦‚æœåŒä¸€ä¸ªç”Ÿæˆå™¨æœ‰ç¬¬äºŒä¸ªæç¤ºç¬¦ï¼Œé‚£ä¹ˆåŒæ ·çš„è¾“å…¥å°†ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç¬¬äºŒä¸ªå€¼ã€‚

åƒ `confirm` å’Œ`list`è¿™æ ·çš„æç¤ºå°½é‡è®©ä½ çš„è¾“å…¥æœ‰æ„ä¹‰ã€‚
ä¾‹å¦‚ï¼Œè¾“å…¥â€œyâ€ï¼Œâ€œyesâ€ï¼Œâ€œtâ€ï¼Œæˆ–â€œtrueâ€ä½œä¸ºç¡®è®¤æç¤ºç¬¦å°†ä¼šå¾—åˆ°ä¸€ä¸ªå¸ƒå°”å€¼ã€‚
æ‚¨å¯ä»¥ä½¿ç”¨é¡¹çš„å€¼ã€ç´¢å¼•ã€é”®æˆ–åç§°ä»åˆ—è¡¨ä¸­é€‰æ‹©é¡¹ã€‚
å¤é€‰æ¡†æç¤ºå¯ä»¥æ¥å—ç”¨é€—å·åˆ†éš”çš„å€¼åˆ—è¡¨ï¼Œä»¥ä¾¿é€‰æ‹©å¤šä¸ªå€¼ã€‚

![plop bypass demo](https://media.giphy.com/media/3ov9jQ38ypmX4SuT60/giphy.gif)

> å¦‚æœä½ æƒ³ä¸ºç¬¬äºŒä¸ªæç¤ºç¬¦è€Œä¸æ˜¯ç¬¬ä¸€ä¸ªæç¤ºç¬¦æä¾›æ—è·¯è¾“å…¥ï¼Œ
> ä½ å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ "\_" æ¥è·³è¿‡æ—è·¯(å³`plop component _ "input for second prompt"`)ã€‚

Plop ä¸ºæ ‡å‡†çš„ inquirer æç¤ºæä¾›äº†å†…ç½®çš„æ—è·¯é€»è¾‘ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥æä¾›è‡ªå®šä¹‰çš„é€»è¾‘æ¥å¤„ç†ç‰¹å®šæç¤ºçš„ç”¨æˆ·è¾“å…¥ã€‚

å¦‚æœæ‚¨å·²ç»å‘å¸ƒäº†ç¬¬3æ–¹æŸ¥è¯¢è€…æç¤ºæ’ä»¶ï¼Œå¹¶ä¸”æƒ³ä¸ºå³è£…å³ç”¨ç”¨æˆ·æä¾›æ—è·¯åŠŸèƒ½ï¼Œ[åˆ™æœ¬æ–‡æ¡£çš„å¦ä¸€éƒ¨åˆ†å°†](#3rd-party-prompt-bypass)å¯¹æ­¤è¿›è¡Œä»‹ç»ã€‚

### ç»•è¿‡æç¤º(æŒ‰åç§°)
è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨ `--` åç§°ç»•è¿‡æç¤ºï¼Œç„¶åä¸ºå¸Œæœ›ç»•è¿‡çš„æ¯ä¸ªæç¤ºæä¾›å‚æ•°ã€‚[ä¸‹é¢](#bypass-examples)çš„ä¾‹å­ã€‚

#### ç»•è¿‡ç¤ºä¾‹
```
## ç»•è¿‡æç¤ºç¬¦ 1 å’Œ 2
$ plop component "my component" react
$ plop component -- --name "my component" --type react

## ä»…è·³è¿‡æç¤ºç¬¦ 2 (å°†æç¤ºåç§°)
$ plop component _ react
$ plop component -- --type react
```

### å¼ºåˆ¶è¿è¡Œç”Ÿæˆå™¨
é»˜è®¤æƒ…å†µä¸‹ï¼ŒPlopåŠ¨ä½œå¯ä»¥è®©ä½ çš„æ–‡ä»¶å®‰å…¨ï¼Œå½“äº‹æƒ…çœ‹èµ·æ¥å¯ç–‘æ—¶å¤±è´¥ã€‚
æœ€æ˜æ˜¾çš„ä¾‹å­æ˜¯ä¸å…è®¸[`add`](#add)æ“ä½œè¦†ç›–å·²ç»å­˜åœ¨çš„æ–‡ä»¶ã€‚
Plopæ“ä½œå•ç‹¬æ”¯æŒ `force` å±æ€§ï¼Œä½†ä½ ä¹Ÿå¯ä»¥åœ¨ç»ˆç«¯è¿è¡Œ Plop æ—¶ä½¿ç”¨ `--force` æ ‡å¿—ã€‚
ä½¿ç”¨ `--force` æ ‡å¿—å°†å‘Šè¯‰æ¯ä¸ªè¡ŒåŠ¨éƒ½å¿…é¡»å¼ºåŠ›æ‰§è¡Œã€‚æœ‰å¤§èƒ½åŠ›â€¦â€¦ğŸ•·

## ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç”Ÿæˆå™¨ï¼Ÿ
å› ä¸ºå½“æ‚¨ä»ä»£ç ä¸­ç‹¬ç«‹åˆ›å»ºæ ·æ¿æ–‡ä»¶æ—¶ï¼Œæ‚¨è‡ªç„¶ä¼šæŠ•å…¥æ›´å¤šçš„æ—¶é—´å’Œæ€è€ƒã€‚

å› ä¸ºå½“åˆ›å»ºæ¯ä¸ªè·¯ç”±ã€ç»„ä»¶ã€æ§åˆ¶å™¨ã€åŠ©æ‰‹ã€æµ‹è¯•ã€è§†å›¾ç­‰æ—¶ï¼Œå¯ä»¥ä¸ºä½ çš„å›¢é˜Ÿ(æˆ–ä½ è‡ªå·±)èŠ‚çœ 5 - 15 åˆ†é’Ÿ, [çœŸçš„åŠ èµ·æ¥](https://xkcd.com/1205/)ã€‚

å› ä¸º[ä¸Šä¸‹æ–‡åˆ‡æ¢éå¸¸æ˜‚è´µ](https://www.petrikainulainen.net/software-development/processes/the-cost-of-context-switching/)ï¼Œå¹¶ä¸”èŠ‚çœæ—¶é—´å¹¶ä¸æ˜¯[è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹](https://kentcdodds.com/blog/automation)çš„å”¯ä¸€å¥½å¤„

# Plopfile Api

plopfile api æ˜¯ç”± `plop` å¯¹è±¡å…¬å¼€çš„æ–¹æ³•é›†åˆã€‚å¤§éƒ¨åˆ†å·¥ä½œæ˜¯ç”±[`setGenerator`](#setgenerator)å®Œæˆçš„ï¼Œä½†æœ¬èŠ‚ä»‹ç»äº† plopfile ä¸­å¯èƒ½ä¹Ÿæœ‰ç”¨çš„å…¶ä»–æ–¹æ³•ã€‚

## TypeScript å£°æ˜

`plop` ç»‘å®šTypeScriptå£°æ˜ã€‚
ä¸ç®¡ä½ æ˜¯å¦ç”¨ TypeScript ç¼–å†™plopfileï¼Œå¾ˆå¤šç¼–è¾‘å™¨éƒ½ä¼šé€šè¿‡è¿™äº›å£°æ˜æä¾›ä»£ç å¸®åŠ©ã€‚

```javascript
// plopfile.ts
import {NodePlopAPI} from 'plop';

export default function (plop: NodePlopAPI) {
  // plop ç”Ÿæˆå™¨ä»£ç 
};
```

```javascript
// plopfile.js
module.exports = function (
	/** @type {import('plop').NodePlopAPI} */
	plop
) {
	// plop ç”Ÿæˆå™¨ä»£ç 
};
```

## ä¸»è¦æ–¹æ³•
è¿™äº›æ˜¯åœ¨åˆ›å»º plopfile æ—¶å¸¸ç”¨çš„æ–¹æ³•ã€‚å…¶ä»–ä¸»è¦ç”¨äºå†…éƒ¨ä½¿ç”¨çš„æ–¹æ³•åœ¨[å…¶ä»–æ–¹æ³•](#å…¶ä»–æ–¹æ³•)ä¸€èŠ‚ä¸­åˆ—å‡ºã€‚

æ–¹æ³• | å‚æ•° | è¿”å› | è¯´æ˜
------ | ---------- | ------- | -----------
[**setGenerator**](#setgenerator) | *String, [GeneratorConfig](#interface-generatorconfig)* | *[GeneratorConfig](#interface-generatorconfig)* | è®¾ç½®ä¸€ä¸ªç”Ÿæˆå™¨
[**setHelper**](#sethelper) | *String, Function* | | è®¾ç½®ä¸€ä¸ª handlebars åŠ©æ‰‹
[**setPartial**](#setpartial) | *String, String* | | è®¾ç½®ä¸€ä¸ª handlebars éƒ¨åˆ†
[**setActionType**](#setactiontype) | *String, [CustomAction](#functionsignature-custom-action)* | | æ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰æ“ä½œç±»å‹
[**setPrompt**](#setprompt) | *String, InquirerPrompt* | | registers a custom prompt type with inquirer
[**load**](https://github.com/amwmedia/plop/blob/master/plop-load.md) | *Array[String], Object, Object* | | loads generators, helpers and/or partials from another plopfile or npm module

## setHelper

`setHelper` ç›´æ¥å¯¹åº”äº handlebars æ–¹æ³•`registerHelper`ã€‚ å› æ­¤ï¼Œå¦‚æœæ‚¨ç†Ÿæ‚‰[handlebars helpers](https://handlebarsjs.com/guide/expressions.html#helpers)ï¼Œé‚£ä¹ˆæ‚¨å·²ç»çŸ¥é“å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

``` javascript
module.exports = function (plop) {
	plop.setHelper('upperCase', function (text) {
		return text.toUpperCase();
	});

	// æˆ–è€…åœ¨ es6/es2015
	plop.setHelper('upperCase', (txt) => txt.toUpperCase());
};
```

## setPartial
`setPartial` ç›´æ¥å¯¹åº”äº handlebars æ–¹æ³•`registerPartial`ã€‚ å› æ­¤ï¼Œå¦‚æœæ‚¨ç†Ÿæ‚‰[handlebars partials](https://handlebarsjs.com/guide/partials.html)ï¼Œé‚£ä¹ˆæ‚¨å·²ç»çŸ¥é“å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

``` javascript
module.exports = function (plop) {
	plop.setPartial('myTitlePartial', '<h1>{{titleCase name}}</h1>');
	// åœ¨æ¨¡æ¿ä¸­ç”¨ä½œ {{> myTitlePartial }}
};
```

## setActionType
`setActionType` å…è®¸ä½ åˆ›å»ºè‡ªå·±çš„åŠ¨ä½œ(ç±»ä¼¼äº`add`æˆ–`modify`)ï¼Œå¯ä»¥åœ¨ä½ çš„ plopfiles ä¸­ä½¿ç”¨ã€‚å®ƒä»¬åŸºæœ¬ä¸Šæ˜¯é«˜åº¦å¯é‡ç”¨çš„[è‡ªå®šä¹‰åŠ¨ä½œå‡½æ•°](#custom-action-function-)ã€‚

### *FunctionSignature* è‡ªå®šä¹‰æ“ä½œ
å‚æ•° | ç±»å‹ | è¯´æ˜
---------- | ---- | -----------
**answers** | *Object* | ç”Ÿæˆå™¨æç¤ºçš„ç­”æ¡ˆ
**config** | *[ActionConfig](#interface-actionconfig)* | ç”Ÿæˆå™¨çš„ `actions` æ•°ç»„ä¸­çš„å¯¹è±¡
**plop** | *[PlopfileApi](#plopfile-api)* | è¿™ä¸ªæ“ä½œæ­£åœ¨è¿è¡Œçš„ plopfile çš„ plop api

``` javascript
module.exports = function (plop) {

	plop.setActionType('doTheThing', function (answers, config, plop) {
		// åšç‚¹ä»€ä¹ˆ
		doSomething(config.configProp);
		// å¦‚æœå‡ºäº†ä»€ä¹ˆé—®é¢˜
		throw 'é”™è¯¯æ¶ˆæ¯';
		// å¦åˆ™
		return 'æˆåŠŸçŠ¶æ€æ¶ˆæ¯';
	});

	// æˆ–åœ¨åŠ¨ä½œä¸­æ‰§è¡Œå¼‚æ­¥æ“ä½œ
	plop.setActionType('doTheAsyncThing', function (answers, config, plop) {
		// åšç‚¹ä»€ä¹ˆ
		return new Promise((resolve, reject) => {
			if (success) {
				resolve('æˆåŠŸçŠ¶æ€æ¶ˆæ¯');
			} else {
				reject('error message');
			}
		});
	});

	// ä½¿ç”¨è‡ªå®šä¹‰æ“ä½œ
	plop.setGenerator('test', {
		prompts: [],
		actions: [{
			type: 'doTheThing',
			configProp: 'available from the config param'
		}, {
			type: 'doTheAsyncThing',
			speed: 'slow'
		}]
	});
};
```

## setPrompt
[Inquirer](https://github.com/SBoudrias/Inquirer.js) æä¾›äº†è®¸å¤šå¼€ç®±å³ç”¨çš„æç¤ºç±»å‹ï¼Œä½†å®ƒä¹Ÿå…è®¸å¼€å‘äººå‘˜æ„å»ºæç¤ºæ’ä»¶ã€‚
å¦‚æœä½ æƒ³ä½¿ç”¨ä¸€ä¸ªæç¤ºæ’ä»¶ï¼Œä½ å¯ä»¥ç”¨`setPrompt`æ³¨å†Œå®ƒã€‚
æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§[ç”¨äºæ³¨å†Œæç¤ºçš„æŸ¥è¯¢è€…æ–‡æ¡£](https://github.com/SBoudrias/Inquirer.js#inquirerregisterpromptname-prompt)ã€‚
å¦è¯·æŸ¥çœ‹[plopç¤¾åŒºé©±åŠ¨çš„è‡ªå®šä¹‰æç¤ºåˆ—è¡¨](https://github.com/amwmedia/plop/blob/master/inquirer-prompts.md)ã€‚

``` javascript
const promptDirectory = require('inquirer-directory');
module.exports = function (plop) {
	plop.setPrompt('directory', promptDirectory);
	plop.setGenerator('test', {
		prompts: [{
			type: 'directory',
			...
		}]
	});
};
```

## setGenerator
é…ç½®å¯¹è±¡éœ€è¦åŒ…å« `prompts` å’Œ`actions` ï¼ˆ`description` æ˜¯å¯é€‰çš„ï¼‰ã€‚
æç¤ºæ•°ç»„å°†ä¼ é€’ç»™[inquirer](https://github.com/SBoudrias/Inquirer.js/#objects)ã€‚
`actions`æ•°ç»„æ˜¯è¦æ‰§è¡Œçš„æ“ä½œçš„åˆ—è¡¨ï¼ˆä¸‹é¢å°†è¯¦ç»†ä»‹ç»ï¼‰

### *Interface* `GeneratorConfig`
å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜
-------- | ---- | ------- | -----------
**description** | *[String]* | | å¯¹è¿™ä¸ªç”Ÿæˆå™¨çš„ç®€çŸ­æè¿°
**prompts** | *Array[[InquirerQuestion](https://github.com/SBoudrias/Inquirer.js/#question)]* | | å‘ç”¨æˆ·è¯¢é—®çš„é—®é¢˜
**actions** | *Array[[ActionConfig](#interface-actionconfig)]* | | è¦æ‰§è¡Œçš„æ“ä½œ

> å¦‚æœæ‚¨çš„æ“ä½œåˆ—è¡¨éœ€è¦åŠ¨æ€æ˜¾ç¤ºï¼Œè¯·æŸ¥çœ‹[ä½¿ç”¨åŠ¨æ€åŠ¨ä½œæ•°ç»„](#ä½¿ç”¨åŠ¨æ€åŠ¨ä½œæ•°ç»„)ã€‚

### *Interface* `ActionConfig`
The following properties are the standard properties that plop handles internally. Other properties will be required depending on the *type* of action. Also take a look at the [built-in actions](#built-in-actions).

å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜
-------- | ---- | ------- | -----------
**type** | *String* | | the type of action ([`add`](#add), [`modify`](#modify), [`addMany`](#addmany), [etc](#setactiontype))
**force** | *Boolean* | `false` | performs the action [forcefully](#running-a-generator-forcefully) (means different things depending on the action)
**data** | *Object / Function* | `{}` | specifies data that should be mixed with user prompt answers when running this action
**abortOnFail** | *Boolean* | `true` | if this action fails for any reason abort all future actions
**skip** | *Function* | | an optional function that specifies if the action should run

> The `data` property on any `ActionConfig` can also be a `Function` that returns an `Object` or a `Function` that returns a `Promise` that resolves with an `Object`.

> The `skip` function on any `ActionConfig` is optional and should return a string if the action should be skipped. The return value is the reason to skip the action.

> Instead of an Action Object, a [function can also be used](#custom-action-function-)

## å…¶ä»–æ–¹æ³•
æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜
------ | ---------- | ------- | -----------
**getHelper** | *String* | *Function* | get the helper function
**getHelperList** | | *Array[String]* | get a list of helper names
**getPartial** | *String* | *String* | get a handlebars partial by name
**getPartialList** | | *Array[String]* | get a list of partial names
**getActionType** | *String* | *[CustomAction](#functionsignature-custom-action)* | get an actionType by name
**getActionTypeList** | | *Array[String]* | get a list of actionType names
**setWelcomeMessage** | *String* | | Customizes the displayed message that asks you to choose a generator when you run `plop`.
**getGenerator** | *String* | *[GeneratorConfig](#interface-generatorconfig)* | get the [GeneratorConfig](#interface-generatorconfig) by name
**getGeneratorList** | | *Array[Object]* | gets an array of generator names and descriptions
**setPlopfilePath** | *String* | | set the `plopfilePath` value which is used internally to locate resources like template files
**getPlopfilePath** | | *String* | returns the absolute path to the plopfile in use
**getDestBasePath** | | *String* | returns the base path that is used when creating files
**setDefaultInclude** | *Object* | *Object* | sets the default config that will be used for this plopfile if it is consumed by another plopfile using `plop.load()`
**getDefaultInclude** | *String* | *Object* | gets the default config that will be used for this plopfile if it is consumed by another plopfile using `plop.load()`
**renderString** | *String, Object* | *String* | Runs the first parameter (*String*) through the handlebars template renderer using the second parameter (*Object*) as the data. Returns the rendered template.

# Built-In Actions
There are several types of built-in actions you can use in your [GeneratorConfig](#interface-generatorconfig). You specify which `type` of action  (all paths are based on the location of the plopfile), and a template to use.

> The `Add`, `AddMany` and `Modify` actions have an optional `transform` method that can be used to transform the template result before it is written to disk. The `transform` function receives the template result or file contents as a `string` and the action data as arguments. It must return a `string` or a `Promise` that resolves to a `string`.

## Add
The `add` action is used to (you guessed it) add a file to your project. The path property is a handlebars template that will be used to create the file by name. The file contents will be determined by the `template` or `templateFile` property.

Property | Type | Default | Description
-------- | ---- | ------- | -----------
**path** | *String* | | a handlebars template that (when rendered) is the path of the new file
**template** | *String* | | a handlebars template that should be used to build the new file
**templateFile** | *String* | | a path a file containing the `template`
**skipIfExists** | *Boolean* | `false` | skips a file if it already exists (instead of failing)
**transform** | *Function* | | [an optional function](#built-in-actions) that can be used to transform the template result before writing the file to disk
**skip** | *Function* | | *inherited from [ActionConfig](#interface-actionconfig)*
**force** | *Boolean* | `false` | *inherited from [ActionConfig](#interface-actionconfig)* (overwrites files if they exist)
**data** | *Object* | `{}` | *inherited from [ActionConfig](#interface-actionconfig)*
**abortOnFail** | *Boolean* | `true` | *inherited from [ActionConfig](#interface-actionconfig)*

## AddMany
The `addMany` action can be used to add multiple files to your project with a single action. The `destination` property is a handlebars template that will be used to identify the folder that the generated files should go into. The `base` property  can be used to alter what section of the template paths should be omitted when creating files. The paths located by the `templateFiles` glob can use handlebars syntax in their file/folder names if you'd like the added file names to be unique (example: `{{ dashCase name }}.spec.js`).

Property | Type | Default | Description
-------- | ---- | ------- | -----------
**destination** | *String* | | a handlebars template that (when rendered) is the destination folder for the new files
**base** | *String* | | the section of the path that should be excluded when adding files to the `destination` folder
**templateFiles** | *[Glob](https://github.com/sindresorhus/globby#globbing-patterns)* | | glob pattern that matches multiple template files to be added
**stripExtensions** | *[String]* | `['hbs']` | file extensions that should be stripped from `templateFiles` files names while being added to the `destination`
**globOptions** | *[Object](https://github.com/sindresorhus/globby#options)* | | glob options that change how to match to the template files to be added
**verbose** | *Boolean* | `true` | print each successfully added file path
**transform** | *Function* | | [an optional function](#built-in-actions) that can be used to transform the template result before writing each file to disk
**skip** | *Function* | | *inherited from [ActionConfig](#interface-actionconfig)*
**skipIfExists** | *Boolean* | `false` | *inherited from [Add](#add)* (skips a file if it already exists)
**force** | *Boolean* | `false` | *inherited from [ActionConfig](#interface-actionconfig)* (overwrites files if they exist)
**data** | *Object* | `{}` | *inherited from [ActionConfig](#interface-actionconfig)*
**abortOnFail** | *Boolean* | `true` | *inherited from [ActionConfig](#interface-actionconfig)*

## Modify
The `modify` action can be used two ways. You can use a `pattern` property to find/replace text in the file located at the `path` specified, or you can use a `transform` function to transform the file contents. Both `pattern` and `transform` can be used at the same time (`transform` will happen last). More details on modify can be found in the example folder.

Property | Type | Default | Description
-------- | ---- | ------- | -----------
**path** | *String* | | handlebars template that (when rendered) is the path of the file to be modified
**pattern** | *RegExp* | _end&#x2011;of&#x2011;file_ | regular expression used to match text that should be replaced
**template** | *String* | | handlebars template that should replace what was matched by the `pattern`. capture groups are available as $1, $2, etc
**templateFile** | *String* | | path a file containing the `template`
**transform** | *Function* | | [an optional function](#built-in-actions) that can be used to transform the file before writing it to disk
**skip** | *Function* | | *inherited from [ActionConfig](#interface-actionconfig)*
**data** | *Object* | `{}` | *inherited from [ActionConfig](#interface-actionconfig)*
**abortOnFail** | *Boolean* | `true` | *inherited from [ActionConfig](#interface-actionconfig)*

## Append
The `append` action is a commonly used subset of `modify`. It is used to append data in a file at a particular location.

Property | Type | Default | Description
-------- | ---- | ------- | -----------
**path** | *String* | | handlebars template that (when rendered) is the path of the file to be modified
**pattern** | *RegExp, String* | | regular expression used to match text where the append should happen
**unique** | *Boolean* | `true` | whether identical entries should be removed
**separator** | *String* | `new line` | the value that separates entries
**template** | *String* | | handlebars template to be used for the entry
**templateFile** | *String* | | path a file containing the `template`
**data** | *Object* | `{}` | *inherited from [ActionConfig](#interface-actionconfig)*
**abortOnFail** | *Boolean* | `true` | *inherited from [ActionConfig](#interface-actionconfig)*

## Custom (Action Function)
The `Add` and `Modify` actions will take care of almost every case that plop is designed to handle. However, plop does offer custom action functions for the node/js guru. A custom action function is a function that is provided in the actions array.
- Custom action functions are executed by plop with the same [CustomAction](#functionsignature-custom-action) function signature.
- Plop will wait for the custom action to complete before executing the next action.
- The function must let plop known whatâ€™s happening through the return value. If you return a `Promise`, we wonâ€™t start other actions until the promise resolves. If you return a message (*String*), we know that the action is done and weâ€™ll report the message in the status of the action.
- A custom action fails if the promise is rejected, or the function throws an `Exception`

_See the [example plopfile](https://github.com/amwmedia/plop/blob/master/example/plopfile.js) for a sample synchronous custom action._

## Comments
Comment lines can be added to the actions array by adding a string in place of an action config object. Comments are printed to the screen when plop comes to them and have no functionality of their own.

# Built-In Helpers
There are a few helpers that I have found useful enough to include with plop. They are mostly case modifiers, but here is the complete list.

## Case Modifiers
- **camelCase**: changeFormatToThis
- **snakeCase**: change_format_to_this
- **dashCase/kebabCase**: change-format-to-this
- **dotCase**: change.format.to.this
- **pathCase**: change/format/to/this
- **properCase/pascalCase**: ChangeFormatToThis
- **lowerCase**: change format to this
- **sentenceCase**: Change format to this,
- **constantCase**: CHANGE_FORMAT_TO_THIS
- **titleCase**: Change Format To This

## Other Helpers
- **pkg**: look up a property from a package.json file in the same folder as the plopfile.

# Taking it Further

There is not a lot needed to get up and running on some basic generators. However, if you want to take your plop-fu further, read on young padawan.

## Using a Dynamic Actions Array
Alternatively, the `actions` property of the [GeneratorConfig](#interface-generatorconfig) can itself be a function that takes the answers data as a parameter and returns the actions array.

This allows you to adapt the actions array based on provided answers:

``` javascript
module.exports = function (plop) {
	plop.setGenerator('test', {
		prompts: [{
			type: 'confirm',
			name: 'wantTacos',
			message: 'Do you want tacos?'
		}],
		actions: function(data) {
			var actions = [];

			if(data.wantTacos) {
				actions.push({
					type: 'add',
					path: 'folder/{{dashCase name}}.txt',
					templateFile: 'templates/tacos.txt'
				});
			} else {
				actions.push({
					type: 'add',
					path: 'folder/{{dashCase name}}.txt',
					templateFile: 'templates/burritos.txt'
				});
			}

			return actions;
		}
	});
};
```

## 3rd Party Prompt Bypass
If you have written an inquirer prompt plugin and want to support plop's bypass functionality, the process is pretty simple. The plugin object that your prompt exports should have a `bypass` function. This `bypass` function will be run by plop with the user's input as the first parameter and the prompt config object as the second parameter. The value that this function returns will be added to the answer data object for that prompt.

``` javascript
// My confirmation inquirer plugin
module.exports = MyConfirmPluginConstructor;
function MyConfirmPluginConstructor() {
	// ...your main plugin code
	this.bypass = (rawValue, promptConfig) => {
		const lowerVal = rawValue.toString().toLowerCase();
		const trueValues = ['t', 'true', 'y', 'yes'];
		const falseValues = ['f', 'false', 'n', 'no'];
		if (trueValues.includes(lowerVal)) return true;
		if (falseValues.includes(lowerVal)) return false;
		throw Error(`"${rawValue}" is not a valid ${promptConfig.type} value`);
	};
	return this;
}
```
> For the above example, the bypass function takes the user's text input and turns it into a `Boolean` value that will be used as the prompt answer data.

### Adding Bypass Support to Your Plopfile
If the 3rd party prompt plugin you are using does not support bypass by default, you can add the `bypass` function above to your prompt's config object and plop will use it for handling bypass data for that prompt.

## Wrapping Plop

Plop provides a lot of powerful functionality "for free". This utility is so powerful, in fact, that you can even wrap `plop`
into your own CLI project. To do so, you only need a `plopfile.js`, a `package.json`, and a template to reference.

Your `index.js` file should look like the following:

```javascript
#!/usr/bin/env node
const path = require('path');
const args = process.argv.slice(2);
const {Plop, run} = require('plop');
const argv = require('minimist')(args);

Plop.launch({
  cwd: argv.cwd,
  // In order for `plop` to always pick up the `plopfile.js` despite the CWD, you must use `__dirname`
  configPath: path.join(__dirname, 'plopfile.js'),
  require: argv.require,
  completion: argv.completion
// This will merge the `plop` argv and the generator argv.
// This means that you don't need to use `--` anymore
}, env => run(env, undefined, true));
```

> Be aware that if you choose to use the `env => run(env, undefined, true))`, you may run into command merging issues
> when using generator arg passing.
>
> If you'd like to opt-out of this behavior and act like plop does (requiring `--` before passing named arguments to generators)
> simply replace the `env =>` arrow function with `run`:
>
>```javascript
>Plop.launch({}, run);
>```

And your `package.json` should look like the following:

```json
{
  "name": "create-your-name-app",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": {
    "start": "plop",
  },
  "bin": {
    "create-your-name-app": "./index.js"
  },
  "preferGlobal": true,
  "dependencies": {
    "plop": "^2.6.0"
  }
}
```

### Setting the base destination path for the wrapper

When wrapping plop, you might want to have the destination path to be based on the cwd when running the wrapper. You can configure the `dest` base path like this:

```javascript
Plop.launch({
	// config like above
}, env => {
	const options = {
		...env,
		dest: process.cwd() // this will make the destination path to be based on the cwd when calling the wrapper
	}
	return run(options, undefined, true)
})
```

### Adding General CLI Actions

Many CLI utilities handle some actions for you, such as running `git init` or `npm install` once the template is generated.

While we'd like to provide these actions, we also want to keep the core actions limited in scope. As such, we maintain a collection of libraries built to add these actions to Plop in [our Awesome Plop list](https://github.com/plopjs/awesome-plop). There, you'll be able to find options for those actions, or even build your own and add it to the list!

### Further Customization

While `plop` provides a great level of customization for CLI utility wrappers, there may be usecases where you simply
want more control over the CLI experience while also utilizing the template generation code.

Luckily, [`node-plop`](https://github.com/plopjs/node-plop/) may be for you! It's what the `plop` CLI itself is built
upon and can be easily extended for other usage in the CLI. However, be warned, documentation is not quite as fleshed out
for integration with `node-plop`. That is to say `Thar be dragons`.

> We note lackluster documentation on `node-plop` integration not as a point of pride, but rather a word of warning.
> If you'd like to contribute documentation to the project, please do so! We always welcome and encourage contributions!
